# Yutto-bilibili-video-downloader 视频下载器 
一个基于yutto的下载视频脚本，可以根据已有的含有bvid (avid) 的csv文件下载所有目标视频文件。可根据需要配置ip代理
## 项目简介
本项目是一个基于 Python 的视频下载工具，支持从 CSV 文件中读取视频 ID (`avid`)，并通过代理从指定平台（如 Bilibili）下载视频。下载过程中支持错误记录、进度保存，以及封面图片提取。
---
## 功能特点

1. **自动代理获取**：通过指定的代理 API 获取有效的代理 IP，并在代理过期时自动更新。
2. **支持批量下载**：从 CSV 文件中读取视频 ID，按需批量下载视频。
3. **断点续传**：支持记录已完成的下载，避免重复下载。
4. **日志记录**：详细记录下载日志、错误日志和进度日志，方便排查问题。
5. **封面提取**：通过 `ffmpeg` 提取视频的封面图片。
6. **超时处理**：设置下载和封面提取的超时时间，保证程序稳定运行。
---
## 使用方法
### 1. 环境准备
请确保您的系统已安装以下依赖工具和 Python 库：
- **依赖工具**：
  - [ffmpeg](https://ffmpeg.org/)：用于提取视频封面图片。
  - [yutto](https://github.com/yutto-downloader/yutto)：用于下载视频。
- **Python 库**：
  - pandas
  - requests
  - tqdm
  - logging
使用以下命令安装所需库：
```bash
pip install pandas requests tqdm
```
### 2. CSV 文件格式
需要准备一个 CSV 文件，文件中需要包含以下列：
avid：视频的唯一 ID。

### 3. 运行程序
运行程序时需要指定以下参数：
- **批次名称**：
  - 将作为输入 CSV 文件的名称（不含扩展名）以及输出目录的名称。eg. python dv6.py <批次名称>
程序将自动：
  - 从指定的代理 API 获取代理。
  - 从输入的 CSV 文件中读取 avid。
  - 下载对应的视频并记录下载进度。
  - 提取视频封面图片。
程序运行后将在 small_output/<批次名称> 目录下生成以下结构的文件和文件夹：
```bash
small_output/
├── <批次名称>/
│   ├── error_log.txt          # 错误日志，记录下载失败的视频 ID
│   ├── progress_log.txt       # 进度日志，记录已完成的视频 ID
│   ├── <avid>/                # 每个视频的下载目录
│   │   ├── merge/             # 合并后的完整视频
│   │   ├── audio_only/        # 音频文件
│   │   ├── video_only/        # 视频文件
│   ├── <批次名称>_log.txt     # 下载日志
```
### 4. 注意事项
1.代理IP配置：
如果需要更换代理服务，请修改代码中 ip_url 的值。

2.超时时间：
  - 下载超时时间为 180 秒。
  - 封面提取超时时间为 60 秒。
  - 如果遇到超时问题，可以在代码中调整超时设置。
